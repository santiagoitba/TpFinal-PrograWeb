<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cripto - EZMoney</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1>Cripto - EZMoney</h1>
    <nav>
      <a href="index.html" class="nav-link">Inicio</a>
      <a href="trading.html" class="nav-link">Trading</a>
      <a href="marketing.html" class="nav-link">Marketing Digital</a>
      <a href="diseno.html" class="nav-link">Diseño</a>
    </nav>
  </header>

  <main>
    <section class="intro">
      <h2>¡Bienvenido al mundo Cripto!</h2>
      <p>
        Aprendé sobre criptomonedas, blockchain y estrategias de inversión con nuestros instructores y la comunidad. Sumate a la revolución financiera.
      </p>
    </section>

    <section class="instructores">
      <h2>Instructores principales</h2>
      <div class="instructores-grid">
        <div class="instructor-card">
          <img src="juan-perez.jpg" alt="Juan Pérez" class="instructor-img" />
          <h3>Juan Pérez</h3>
          <p>Especialista en Cripto y Blockchain</p>
          <form class="form-turno-comunidad">
            <input type="hidden" class="instructor-nombre" value="Juan Pérez" />
            <label>Tu nombre:</label>
            <input type="text" class="nombre" required />
            <label>Tu email:</label>
            <input type="email" class="email" required />
            <label>Fecha:</label>
            <input type="date" class="fecha" required />
            <label>Horario:</label>
            <select class="horario" required>
              <option value="">Elegí un horario</option>
              <option value="09:00">09:00</option>
              <option value="11:00">11:00</option>
              <option value="14:00">14:00</option>
              <option value="16:00">16:00</option>
              <option value="18:00">18:00</option>
            </select>
            <button type="submit">Agendar turno</button>
          </form>
        </div>
        <!-- Aquí se agregan los instructores de la comunidad dinámicamente -->
      </div>
    </section>

    <section class="comunidad">
      <h2>¿Querés ser instructor de la comunidad?</h2>
      <form id="form-comunidad">
        <label for="nombre-comunidad">Tu nombre:</label>
        <input type="text" id="nombre-comunidad" required />
        <label for="especialidad-comunidad">Especialidad:</label>
        <input type="text" id="especialidad-comunidad" required />
        <label for="img-comunidad">Foto de perfil:</label>
        <input type="file" id="img-comunidad" accept="image/*" required />
        <button type="submit">Sumarme como instructor</button>
      </form>
    </section>

    <section>
      <h2>Turnos agendados</h2>
      <ul id="lista-turnos"></ul>
    </section>
  </main>

  <footer>
    &copy; 2025 EZMoney - Todos los derechos reservados
  </footer>

  <script>
    // Bloquear fechas pasadas y el mismo día en todos los formularios
    function setMinDate(inputs) {
      const hoy = new Date();
      hoy.setDate(hoy.getDate() + 1);
      const min = hoy.toISOString().split('T')[0];
      inputs.forEach(input => input.min = min);
    }

    // Renderizar instructores de la comunidad
    function renderComunidadInstructores() {
      const instructores = JSON.parse(localStorage.getItem('instructoresComunidad')) || [];
      const grid = document.querySelector('.instructores-grid');
      // El primer hijo es el instructor principal, los demás son de la comunidad
      grid.querySelectorAll('.comunidad-card').forEach(card => card.remove());

      instructores.forEach((inst, idx) => {
        const card = document.createElement('div');
        card.className = 'instructor-card comunidad-card';
        card.innerHTML = `
          <img src="${inst.img}" alt="${inst.nombre}" class="instructor-img" />
          <h3>${inst.nombre}</h3>
          <p>${inst.especialidad}</p>
          <form class="form-turno-comunidad">
            <input type="hidden" class="instructor-nombre" value="${inst.nombre}" />
            <label>Tu nombre:</label>
            <input type="text" class="nombre" required />
            <label>Tu email:</label>
            <input type="email" class="email" required />
            <label>Fecha:</label>
            <input type="date" class="fecha" required />
            <label>Horario:</label>
            <select class="horario" required>
              <option value="">Elegí un horario</option>
              <option value="09:00">09:00</option>
              <option value="11:00">11:00</option>
              <option value="14:00">14:00</option>
              <option value="16:00">16:00</option>
              <option value="18:00">18:00</option>
            </select>
            <button type="submit">Agendar turno</button>
          </form>
        `;
        grid.appendChild(card);
      });

      // Set min date para todos los inputs de fecha
      setMinDate(Array.from(document.querySelectorAll('.fecha')));
    }

    // Guardar instructor de la comunidad
    document.getElementById('form-comunidad').addEventListener('submit', function(e) {
      e.preventDefault();
      const nombre = document.getElementById('nombre-comunidad').value.trim();
      const especialidad = document.getElementById('especialidad-comunidad').value.trim();
      const imgInput = document.getElementById('img-comunidad');
      const file = imgInput.files[0];

      if (!file) return;

      const reader = new FileReader();
      reader.onload = function(evt) {
        const img = evt.target.result;
        const instructores = JSON.parse(localStorage.getItem('instructoresComunidad')) || [];
        instructores.push({ nombre, especialidad, img });
        localStorage.setItem('instructoresComunidad', JSON.stringify(instructores));
        renderComunidadInstructores();
        document.getElementById('form-comunidad').reset();
      };
      reader.readAsDataURL(file);
    });

    // Manejo de turnos
    function renderTurnos() {
      const lista = document.getElementById('lista-turnos');
      const turnos = JSON.parse(localStorage.getItem('turnosCripto')) || [];
      lista.innerHTML = '';
      if (turnos.length === 0) {
        lista.innerHTML = '<li>No hay turnos agendados.</li>';
        return;
      }
      turnos.forEach((t, i) => {
        const li = document.createElement('li');
        li.className = 'turno-card';
        li.innerHTML = `
          <div class="turno-info">
            <span class="turno-fecha">${t.fecha} - ${t.horario} hs</span>
            <span class="turno-nombre">${t.nombre} (${t.email})</span>
            <span class="turno-instructor">Instructor: <b>${t.instructor}</b></span>
          </div>
          <button class="borrar-turno" data-index="${i}">Borrar</button>
        `;
        lista.appendChild(li);
      });
    }

    // Agendar turnos con cualquier instructor
    document.body.addEventListener('submit', function(e) {
      if (e.target.classList.contains('form-turno-comunidad')) {
        e.preventDefault();
        const form = e.target;
        const nombre = form.querySelector('.nombre').value.trim();
        const email = form.querySelector('.email').value.trim();
        const fecha = form.querySelector('.fecha').value;
        const horario = form.querySelector('.horario').value;
        const instructor = form.querySelector('.instructor-nombre').value;

        // Validar que no haya turno en el mismo horario con el mismo instructor
        const turnos = JSON.parse(localStorage.getItem('turnosCripto')) || [];
        const existe = turnos.some(t => t.instructor === instructor && t.fecha === fecha && t.horario === horario);
        if (existe) {
          alert('Ya hay un turno reservado para ese instructor, fecha y horario.');
          return;
        }

        turnos.push({ nombre, email, fecha, horario, instructor });
        localStorage.setItem('turnosCripto', JSON.stringify(turnos));
        renderTurnos();
        form.reset();
        alert('¡Turno agendado con éxito!');
      }
    });

    // Borrar turnos
    document.getElementById('lista-turnos').addEventListener('click', function(e) {
      if (e.target.classList.contains('borrar-turno')) {
        const idx = e.target.dataset.index;
        const turnos = JSON.parse(localStorage.getItem('turnosCripto')) || [];
        if (confirm('¿Seguro que querés borrar este turno?')) {
          turnos.splice(idx, 1);
          localStorage.setItem('turnosCripto', JSON.stringify(turnos));
          renderTurnos();
        }
      }
    });

    // Inicialización
    renderComunidadInstructores();
    renderTurnos();
    setMinDate(Array.from(document.querySelectorAll('.fecha')));
  </script>
</body>
</html>
